!function(n,e,t){t=this;e=e(t,{});for(var a in e)e.hasOwnProperty(a)&&!function(n){e.prototype[n]=function(){e[n].apply(null,[].concat.call(this.channel,[].slice.call(arguments)));return this}}(a);typeof define==="function"&&typeof module!=="undefined"?module.exports=e:(t["Hao123"]||(t["Hao123"]={}))[n]=e}.call(window,"message",function(n,e,t){var a="postMessage"in n,i=+new Date,o=n.navigator,r=!!function(n){try{localStorage.setItem(i,i);n=localStorage.getItem(i)==i;localStorage.removeItem(i);return n}catch(e){}}()&&localStorage,f=function(n,e){for(var t=0,a=n.length;t<a;t++)if(e(n[t],t,n)===!1)break},c=function(n){if(!(this instanceof c))return new c(n);this.channel=n},s=function(n){var t,a;try{t=JSON.parse(n.data)}catch(n){return}t&&(a=t.channel)&&(a=e[a])&&f(a,function(n){n&&n(t.data)})},u={iframe:function(){if(a){if(n.addEventListener)n.addEventListener("message",s,false);else n.attachEvent("onmessage",s)}this["iframe"]=null},opener:function(){if(a){if(n.addEventListener)n.addEventListener("message",s,false);else n.attachEvent("onmessage",s)}this["iframe"]=null},page:function(){if(r){if(n.addEventListener){n.addEventListener("storage",function(n){var t,a;(t=n.newValue)&&(a=n.key)&&(a=e[a])&&f(a,function(n){n&&n(t)})},false)}else{}}this["page"]=null}};c.send=function(t,i,s){var u=t.split(".")[0];t&&{iframe:a?function(){setTimeout(function(){(s||n.parent).postMessage(JSON.stringify({data:i,channel:t}),"*")},0)}:function(){setTimeout(function(){(t=o[t])&&f(t,function(n){n&&n(i)})},0)},module:function(){setTimeout(function(){(t=e[t])&&f(t,function(n){n&&n(i)})},0)},opener:function(){setTimeout(function(){try{(s||n.parent).postMessage(JSON.stringify({data:i,channel:t}),"*")}catch(e){try{t=n.opener.navigator[t]}catch(e){return}f(t,function(n){n&&n(i)})}},0)},page:r?function(){r[t]=i+"";setTimeout(function(){r.removeItem(t)},0)}:function(){}}[u]();return c};c.on=function(n,t){var i=n.split(".")[0];u[i]&&u[i]();if((i==="iframe"||i==="opener")&&!a){(o[i=n]||(o[i]=[])).push(t)}else n&&(e[n]||(e[n]=[])).push(t);return c};c.off=function(n,t){n&&t?f(e[n],function(a,i){f(t instanceof Array?t:[t],function(t){t===a&&(e[n][i]=null)})}):e[n]=[];return c};return c});